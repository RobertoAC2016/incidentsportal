@model IEnumerable<incident>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css" rel="stylesheet" type="text/css" />


<div class="row">
    <div class="col-12">
        <table id="dttickets" class="display" width="100%"></table>
    </div>
</div>
<script type="text/javascript">

    var dataSet = [
    @foreach (var item in Model)
        {
        @:[@(item.id), '@(item.from)', '@(item.to)', '@(item.importance)', '@(item.subject)', '@(item.message.Length > 50 ? item.message.Substring(0, 49) : item.message)', '@(item.date)', '@(item.status)'],
        }
    ]
    $("#dttickets").DataTable({
        data: dataSet,
        search:{

        },
        columns: [
            { title: 'Id' },
            { title: 'From' },
            { title: 'To' },
            { title: 'Importance' },
            { title: 'Subject' },
            { title: 'Message' },
            { title: 'Date' },
            { title: 'Status' },
            {
                data: null,
                render: function (data, type, row) {
                    return "<div class='btn btn-secondary'>"
                        + "<a href='#' class='text-white' style = 'text-decoration: none;' onclick = 'goedit(this);' >"
                        + "<i class='bi bi-pencil-square'> </i>"
                        + "</a>"
                        + "</div>"
                        + "<div class='btn btn-info'>"
                        + "<a href='#' class='text-white' style = 'text-decoration: none;' onclick = 'goview(this);' >"
                        + "<i class='bi bi-journal-text' > </i>"
                        + "</a>"
                        + "</div>";
                }
            }
        ],
    });
    function goview(ctl) {
        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        document.location = "Data/ViewTT/" + cols[0].innerHTML;
    }
    function goedit(ctl) {
        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        document.location = "Data/EditTicket/" + cols[0].innerHTML;
    }

</script>
